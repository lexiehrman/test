{% comment %}
///////////////////////////////////////////////////////////////////////////////
// --------------------------------------------------------------------------//
// header.liquid
// --------------------------------------------------------------------------//
///////////////////////////////////////////////////////////////////////////////
{% endcomment %}

{% comment %}
Create a nav for every item in the Main Nav that has a corresponding linklist
{% endcomment %}
<nav class="nav" role="navigation">
  <ul class="nav__items">
    {% for link in linklists.main-menu.links %}

      {% assign child_list_handle = link.title | handleize %}

      {% comment %}
      Check for children so we can find if parent link is active in accordian
      {% endcomment %}
      {% assign parent_link_active = false %}
      {% for l in linklists[child_list_handle].links %}
        {% if page_title == l.title or l.active %}
          {% assign parent_link_active = true %}
        {% endif %}
      {% endfor %}

      {% comment %}
      Check for children so we can find if parent link is active in accordian
      {% endcomment %}
      {% if linklists[child_list_handle].links != blank %}

        <li class="nav__item nav__item--has-subnav {% if link.active or parent_link_active  %}nav__item--open{% endif %}">
          <a class="nav__link" href="{{ link.url }}">{{ link.title }}</a>
          <ul class="nav__subitems">
              {% for childlink in linklists[child_list_handle].links %}
              <li class="nav__subitem">
                <a class="nav__sublink {% if childlink.active %}nav__sublink--active{% endif %}" href="{{ childlink.url }}">{{ childlink.title | escape }}</a>
              </li>
              {% endfor %}
          </ul>
        </li>

      {% else %}

        <li class="nav__item nav__item--no-subnav">
          <a class="nav__link {% if link.active %}nav__link--active{% endif %}" href="{{ link.url }}">{{ link.title }}</a>
        </li>

      {% endif %}
    {% endfor %}
  </ul>
</nav>
